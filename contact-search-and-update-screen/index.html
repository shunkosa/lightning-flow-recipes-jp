<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="取引先責任者を名前で検索し、検索した取引先責任者のうちから、対象となるレコードを選択し、その取引先と説明欄を一括更新する画面フローです。
ポイント # 画面要素に入力チェックを適用する # フローでは、姓・名を全角カナのみに制限しています。画面要素の [入力を検証] セクションから入力チェックを適用できます。
使い方は通常の入力規則と同様です。REGEX 関数のサンプルについては、「Salesforce Help - 一般的なREGEX関数を用いた正規表現の検証」 や、「Qiita - form用正規表現判定/備忘」 等を参考にしてください。
コレクション変数のサイズ (件数) を取得する # コレクション変数のサイズを取得するには、数値型の変数を作成し、コレクション変数を割り当てます。これで数値型の変数に自動的にコレクション変数のサイズが割り当てられます。
例えば、[レコードを取得] の結果であるコレクション変数 get_Contacts に取引先責任者が10件含まれている場合、変数 var_NumOfContacts の値は10になります。
複数選択リスト (チェックボックスグループ) の選択結果を取得する # 通常、選択リストで選択された結果を保存するには、[レコード選択肢セット] や [選択リスト選択肢セット] の最後のセクションにある [項目値をさらに保存] を用いますが、これは最後に選択された値しか取得できませんので、複数選択リストやチェックボックスグループの場合は少し工夫が必要です。
複数選択リストやチェックボックスグループの選択結果は、画面要素に ; 区切りで1つの長いテキストとして保存されます。このフローではチェックボックスグループで検索した取引先責任者から更新対象を選択しますが、例えば3件の取引先責任者を選択した場合、input_Contacts の中身は、0031k00000TI6KEAA1; 0031k00000TI6KEBB2; 0031k00000TI6KECC3 のようになります。この長い文字列はこのままでは使えませんので、順番に; 区切りの Id を取り出す必要があります。数式 formula_NextPicklistValue formula_RemainingPicklistValues はそれぞれ、この長いテキストから先頭の Id と残りの文字列を切り取ったものです。最初に input_Contacts の中身を別のテキスト変数 (var_SelectedContactIds) にコピーして、Id を 1つ取りだしながら、取り出した Id を削っていきます。つまり、フローのループでは次のように値が変化していきます。
ループ回数 var_SelectedContactIds formula_NextPicklistValue
(先頭の値) formula_RemainingPicklistValues
(残った値) 1回目 0031k00000TI6KEAA1; 0031k00000TI6KEBB2; 0031k00000TI6KECC3 0031k00000TI6KEAA1 0031k00000TI6KEBB2; 0031k00000TI6KECC3 2回目 00031k00000TI6KEBB2; 0031k00000TI6KECC3 00031k00000TI6KEBB2 0031k00000TI6KECC3 3回目 0031k00000TI6KECC3 0031k00000TI6KECC3 ループ内では合わせて、レコード変数への値の割り当てと、コレクション変数へのレコード変数の追加も行っていますので、ループが終わった時点では、選択された3件のレコード変数が、コレクション変数に追加されています。レコードの更新処理では、このコレクション変数を渡すだけで更新処理が完了します。"><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="取引先責任者の検索・更新画面"><meta property="og:description" content="取引先責任者を名前で検索し、検索した取引先責任者のうちから、対象となるレコードを選択し、その取引先と説明欄を一括更新する画面フローです。
ポイント # 画面要素に入力チェックを適用する # フローでは、姓・名を全角カナのみに制限しています。画面要素の [入力を検証] セクションから入力チェックを適用できます。
使い方は通常の入力規則と同様です。REGEX 関数のサンプルについては、「Salesforce Help - 一般的なREGEX関数を用いた正規表現の検証」 や、「Qiita - form用正規表現判定/備忘」 等を参考にしてください。
コレクション変数のサイズ (件数) を取得する # コレクション変数のサイズを取得するには、数値型の変数を作成し、コレクション変数を割り当てます。これで数値型の変数に自動的にコレクション変数のサイズが割り当てられます。
例えば、[レコードを取得] の結果であるコレクション変数 get_Contacts に取引先責任者が10件含まれている場合、変数 var_NumOfContacts の値は10になります。
複数選択リスト (チェックボックスグループ) の選択結果を取得する # 通常、選択リストで選択された結果を保存するには、[レコード選択肢セット] や [選択リスト選択肢セット] の最後のセクションにある [項目値をさらに保存] を用いますが、これは最後に選択された値しか取得できませんので、複数選択リストやチェックボックスグループの場合は少し工夫が必要です。
複数選択リストやチェックボックスグループの選択結果は、画面要素に ; 区切りで1つの長いテキストとして保存されます。このフローではチェックボックスグループで検索した取引先責任者から更新対象を選択しますが、例えば3件の取引先責任者を選択した場合、input_Contacts の中身は、0031k00000TI6KEAA1; 0031k00000TI6KEBB2; 0031k00000TI6KECC3 のようになります。この長い文字列はこのままでは使えませんので、順番に; 区切りの Id を取り出す必要があります。数式 formula_NextPicklistValue formula_RemainingPicklistValues はそれぞれ、この長いテキストから先頭の Id と残りの文字列を切り取ったものです。最初に input_Contacts の中身を別のテキスト変数 (var_SelectedContactIds) にコピーして、Id を 1つ取りだしながら、取り出した Id を削っていきます。つまり、フローのループでは次のように値が変化していきます。
ループ回数 var_SelectedContactIds formula_NextPicklistValue
(先頭の値) formula_RemainingPicklistValues
(残った値) 1回目 0031k00000TI6KEAA1; 0031k00000TI6KEBB2; 0031k00000TI6KECC3 0031k00000TI6KEAA1 0031k00000TI6KEBB2; 0031k00000TI6KECC3 2回目 00031k00000TI6KEBB2; 0031k00000TI6KECC3 00031k00000TI6KEBB2 0031k00000TI6KECC3 3回目 0031k00000TI6KECC3 0031k00000TI6KECC3 ループ内では合わせて、レコード変数への値の割り当てと、コレクション変数へのレコード変数の追加も行っていますので、ループが終わった時点では、選択された3件のレコード変数が、コレクション変数に追加されています。レコードの更新処理では、このコレクション変数を渡すだけで更新処理が完了します。"><meta property="og:type" content="article"><meta property="og:url" content="https://shunkosa.github.io/lightning-flow-recipes-jp/contact-search-and-update-screen/"><meta property="article:section" content><meta property="article:published_time" content="2020-02-28T00:00:00+00:00"><meta property="article:modified_time" content="2020-02-28T00:00:00+00:00"><title>取引先責任者の検索・更新画面 | Salesforce Flow Recipes</title><link rel=manifest href=/lightning-flow-recipes-jp/manifest.json><link rel=icon href=/lightning-flow-recipes-jp/favicon.png type=image/x-icon><link href="https://fonts.googleapis.com/css?family=Noto+Sans+JP" rel=stylesheet><link rel=stylesheet href=/lightning-flow-recipes-jp/book.min.c43b596a4d60811469270724ebd1598ef06aa86a59d8945595ff128ed09c5fab.css integrity="sha256-xDtZak1ggRRpJwck69FZjvBqqGpZ2JRVlf8SjtCcX6s="><script async src="https://www.googletagmanager.com/gtag/js?id=G-ESEWC9RTQC"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ESEWC9RTQC")</script><script defer src=/lightning-flow-recipes-jp/ja.search.min.82dc4aab6043c7cd02c78418df05e3927c25715757a0dce3425e99d99ced8507.js integrity="sha256-gtxKq2BDx80Cx4QY3wXjknwlcVdXoNzjQl6Z2ZzthQc="></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/lightning-flow-recipes-jp><span>Salesforce Flow Recipes</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=検索 aria-label=検索 maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/lightning-flow-recipes-jp/>トップページ・レシピ集</a></li><li><a href=/lightning-flow-recipes-jp/changelog/>リリースノート</a></li><li>補足<ul><li><a href=/lightning-flow-recipes-jp/design-guideline/>実装時に気をつけると良いこと</a></li></ul></li></ul><br><ul><li><a href=https://github.com/shunkosa/lightning-flow-recipes-jp/ target=_blank rel=noopener>GitHub</a></li></ul></nav><script>(function(){var e=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/lightning-flow-recipes-jp/svg/menu.svg class=book-icon alt=Menu></label>
<strong>取引先責任者の検索・更新画面</strong>
<label for=toc-control><img src=/lightning-flow-recipes-jp/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#ポイント>ポイント</a><ul><li><a href=#画面要素に入力チェックを適用する>画面要素に入力チェックを適用する</a></li><li><a href=#コレクション変数のサイズ-件数-を取得する>コレクション変数のサイズ (件数) を取得する</a></li><li><a href=#複数選択リスト-チェックボックスグループ-の選択結果を取得する>複数選択リスト (チェックボックスグループ) の選択結果を取得する</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1>取引先責任者の検索・更新画面</h1><p>取引先責任者を名前で検索し、検索した取引先責任者のうちから、対象となるレコードを選択し、その取引先と説明欄を一括更新する画面フローです。</p><p><img src=screenshot.png alt></p><h2 id=ポイント>ポイント
<a class=anchor href=#%e3%83%9d%e3%82%a4%e3%83%b3%e3%83%88>#</a></h2><h3 id=画面要素に入力チェックを適用する>画面要素に入力チェックを適用する
<a class=anchor href=#%e7%94%bb%e9%9d%a2%e8%a6%81%e7%b4%a0%e3%81%ab%e5%85%a5%e5%8a%9b%e3%83%81%e3%82%a7%e3%83%83%e3%82%af%e3%82%92%e9%81%a9%e7%94%a8%e3%81%99%e3%82%8b>#</a></h3><p>フローでは、姓・名を全角カナのみに制限しています。画面要素の [入力を検証] セクションから入力チェックを適用できます。</p><p><img src=regex.png alt></p><p>使い方は通常の入力規則と同様です。REGEX 関数のサンプルについては、<a href="https://help.salesforce.com/articleView?id=000334073&language=ja&type=1&mode=1">「Salesforce Help - 一般的なREGEX関数を用いた正規表現の検証」</a> や、<a href=https://qiita.com/fubarworld2/items/9da655df4d6d69750c06>「Qiita - form用正規表現判定/備忘」</a> 等を参考にしてください。</p><h3 id=コレクション変数のサイズ-件数-を取得する>コレクション変数のサイズ (件数) を取得する
<a class=anchor href=#%e3%82%b3%e3%83%ac%e3%82%af%e3%82%b7%e3%83%a7%e3%83%b3%e5%a4%89%e6%95%b0%e3%81%ae%e3%82%b5%e3%82%a4%e3%82%ba-%e4%bb%b6%e6%95%b0-%e3%82%92%e5%8f%96%e5%be%97%e3%81%99%e3%82%8b>#</a></h3><p>コレクション変数のサイズを取得するには、数値型の変数を作成し、コレクション変数を割り当てます。これで数値型の変数に自動的にコレクション変数のサイズが割り当てられます。</p><p><img src=count.png alt></p><p>例えば、[レコードを取得] の結果であるコレクション変数 <code>get_Contacts</code> に取引先責任者が10件含まれている場合、変数 <code>var_NumOfContacts</code> の値は10になります。</p><h3 id=複数選択リスト-チェックボックスグループ-の選択結果を取得する>複数選択リスト (チェックボックスグループ) の選択結果を取得する
<a class=anchor href=#%e8%a4%87%e6%95%b0%e9%81%b8%e6%8a%9e%e3%83%aa%e3%82%b9%e3%83%88-%e3%83%81%e3%82%a7%e3%83%83%e3%82%af%e3%83%9c%e3%83%83%e3%82%af%e3%82%b9%e3%82%b0%e3%83%ab%e3%83%bc%e3%83%97-%e3%81%ae%e9%81%b8%e6%8a%9e%e7%b5%90%e6%9e%9c%e3%82%92%e5%8f%96%e5%be%97%e3%81%99%e3%82%8b>#</a></h3><p>通常、選択リストで選択された結果を保存するには、[レコード選択肢セット] や [選択リスト選択肢セット] の最後のセクションにある [項目値をさらに保存] を用いますが、これは最後に選択された値しか取得できませんので、複数選択リストやチェックボックスグループの場合は少し工夫が必要です。</p><p>複数選択リストやチェックボックスグループの選択結果は、画面要素に <code>;</code> 区切りで1つの長いテキストとして保存されます。このフローではチェックボックスグループで検索した取引先責任者から更新対象を選択しますが、例えば3件の取引先責任者を選択した場合、<code>input_Contacts</code> の中身は、<code>0031k00000TI6KEAA1; 0031k00000TI6KEBB2; 0031k00000TI6KECC3</code> のようになります。この長い文字列はこのままでは使えませんので、順番に<code>;</code> 区切りの Id を取り出す必要があります。数式 <code>formula_NextPicklistValue</code> <code>formula_RemainingPicklistValues</code> はそれぞれ、この長いテキストから先頭の Id と残りの文字列を切り取ったものです。最初に <code>input_Contacts</code> の中身を別のテキスト変数 (<code>var_SelectedContactIds</code>) にコピーして、Id を 1つ取りだしながら、取り出した Id を削っていきます。つまり、フローのループでは次のように値が変化していきます。</p><table><tr><th nowrap>ループ回数</th><th>var_SelectedContactIds</th><th>formula_NextPicklistValue<br>(先頭の値)</th><th>formula_RemainingPicklistValues<br>(残った値)</th></tr><tr><td>1回目</td><td nowrap>0031k00000TI6KEAA1; 0031k00000TI6KEBB2; 0031k00000TI6KECC3</td><td>0031k00000TI6KEAA1</td><td nowrap>0031k00000TI6KEBB2; 0031k00000TI6KECC3</td></tr><tr><td>2回目</td><td nowrap>00031k00000TI6KEBB2; 0031k00000TI6KECC3</td><td nowrap>00031k00000TI6KEBB2</td><td nowrap>0031k00000TI6KECC3</td></tr><tr><td>3回目</td><td>0031k00000TI6KECC3</td><td>0031k00000TI6KECC3</td><td></td></tr></table><p>ループ内では合わせて、レコード変数への値の割り当てと、コレクション変数へのレコード変数の追加も行っていますので、ループが終わった時点では、選択された3件のレコード変数が、コレクション変数に追加されています。レコードの更新処理では、このコレクション変数を渡すだけで更新処理が完了します。</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#ポイント>ポイント</a><ul><li><a href=#画面要素に入力チェックを適用する>画面要素に入力チェックを適用する</a></li><li><a href=#コレクション変数のサイズ-件数-を取得する>コレクション変数のサイズ (件数) を取得する</a></li><li><a href=#複数選択リスト-チェックボックスグループ-の選択結果を取得する>複数選択リスト (チェックボックスグループ) の選択結果を取得する</a></li></ul></li></ul></nav></aside></main></body></html>